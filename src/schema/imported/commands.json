{
  "$id": "commands",
  "description": "Use the commands API to add keyboard shortcuts that trigger actions in your extension, for example opening one of the action popups or sending a command to the extension.",
  "permissions": [
    "manifest:commands"
  ],
  "events": [
    {
      "name": "onCommand",
      "description": "Fired when a registered command is activated using a keyboard shortcut. This is a user input event handler. For asynchronous listeners some `restrictions <|link-user-input-restrictions|>`__ apply.",
      "type": "function",
      "parameters": [
        {
          "name": "command",
          "type": "string"
        },
        {
          "allOf": [
            {
              "$ref": "tabs#/types/Tab"
            },
            {
              "name": "tab",
              "description": "The details of the active tab while the command occurred."
            }
          ]
        }
      ]
    }
  ],
  "functions": [
    {
      "name": "update",
      "type": "function",
      "async": true,
      "description": "Update the details of an already defined command.",
      "parameters": [
        {
          "type": "object",
          "name": "detail",
          "description": "The new details for the command.",
          "properties": {
            "name": {
              "type": "string",
              "description": "The name of the command."
            },
            "description": {
              "type": "string",
              "description": "The description for the command."
            },
            "shortcut": {
              "type": "string",
              "format": "manifestShortcutKeyOrEmpty",
              "description": "An empty string to clear the shortcut, or a string matching the format defined by the `MDN page of the commands API <|link-commands-shortcuts|>`__  to set a new shortcut key. If the string does not match this format, the function throws an error."
            }
          },
          "required": [
            "name"
          ]
        }
      ]
    },
    {
      "name": "reset",
      "type": "function",
      "async": true,
      "description": "Reset a command's details to what is specified in the manifest.",
      "parameters": [
        {
          "type": "string",
          "name": "name",
          "description": "The name of the command."
        }
      ]
    },
    {
      "name": "getAll",
      "type": "function",
      "async": "callback",
      "description": "Returns all the registered extension commands for this extension and their shortcut (if active).",
      "parameters": [
        {
          "type": "function",
          "name": "callback",
          "optional": true,
          "parameters": [
            {
              "name": "commands",
              "type": "array",
              "items": {
                "$ref": "#/types/Command"
              }
            }
          ],
          "description": "Called to return the registered commands."
        }
      ]
    }
  ],
  "definitions": {
    "WebExtensionManifest": {
      "properties": {
        "commands": {
          "type": "object",
          "description": "A <em>dictionary object</em> defining one or more commands as <em>name-value</em> pairs, the <em>name</em> being the name of the command and the <em>value</em> being a :ref:`commands.CommandsShortcut`. The <em>name</em> may also be one of the following built-in special shortcuts: \n * <value>_execute_action</value> \n * <value>_execute_compose_action</value> \n * <value>_execute_message_display_action</value>\nExample: <literalinclude>includes/commands/manifest.json<lang>JSON</lang></literalinclude>",
          "additionalProperties": {
            "type": "object",
            "properties": {
              "suggested_key": {
                "type": "object",
                "properties": {
                  "default": {
                    "$ref": "#/types/KeyName"
                  },
                  "mac": {
                    "$ref": "#/types/KeyName"
                  },
                  "linux": {
                    "$ref": "#/types/KeyName"
                  },
                  "windows": {
                    "$ref": "#/types/KeyName"
                  },
                  "chromeos": {
                    "type": "string"
                  },
                  "android": {
                    "type": "string"
                  },
                  "ios": {
                    "type": "string"
                  },
                  "additionalProperties": {
                    "type": "string",
                    "deprecated": "Unknown platform name"
                  }
                }
              },
              "description": {
                "type": "string",
                "preprocess": "localize"
              }
            }
          }
        }
      }
    }
  },
  "refs": {
    "commands#/definitions/WebExtensionManifest": {
      "namespace": "manifest",
      "type": "WebExtensionManifest"
    }
  },
  "types": {
    "Command": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "description": "The name of the Extension Command"
        },
        "description": {
          "type": "string",
          "description": "The Extension Command description"
        },
        "shortcut": {
          "type": "string",
          "description": "The shortcut active for this command, or blank if not active."
        }
      }
    },
    "KeyName": {
      "type": "string",
      "format": "manifestShortcutKey",
      "description": "Definition of a shortcut, for example <value>Alt+F5</value>. The string must match the shortcut format as defined by the `MDN page of the commands API <|link-commands-shortcuts|>`__."
    }
  }
}
